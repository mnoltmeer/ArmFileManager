	Управляющий скрипт - это файл, содержащий команды для интерпретатора, подключенного к Программе. Функционал интерпретатора содержится в библиотеке ELI.dll, которая должна находиться в одном каталоге с исполняемым файлом Программы. Подключение библиотеки происходит при запуске Программы. Трансляция скрипта выполняется в отдельном потоке. Каждые ScriptInterval минут поток проверяет наличие в каталоге Программы файла с именем, указанным в ControlScriptName. Если файл есть - запускается трансляция, после чего файл удаляется.

	Файл скрипта должен быть в кодировке UTF-8 и не содержать пустых строк в конце. Каждая строка, содержащая команду завершается точкой с запятой (;). В одном файле может быть только один скрипт.


#begin HelloWorld; <--директива, обозначающая начало скрипта и его имя


#end; <--директива обозначающая конец скрипта



	В скрипте можно использовать следующие функции:

_ConnCount() - возвращает количество подключений.
 
_CreateConn(pFile, pAddMenu) - создает новое подключение, возвращает его ИД.
pFile указывает путь к файлу конфига. Можно использовать конструкцию .\<имя файла>, чтобы указать файл в каталоге Программы.
pAddMenu - указывает нужно ли создавать для подключения элемент в контекстном меню.

_DestroyConn(pID) - уничтожает подключение.
pID - ИД подключения.

_RemoveConn(pID) - уничтожает подключение и удаляет его файл конфига.
pID - ИД подключения.

_StartConn(pID) - запускает подключение.
pID - ИД подключения.

_StopConn(pID) - останавливает подключение.
pID - ИД подключения.

_ConnID(pCap) - ищет подключение по его Caption, возвращает ИД или 0, если подключение не найдено.

_ConnIDInd(pIndex) - ищет подключение по его индексу в списке подключений, возвращает ИД или 0, если подключение не найдено.

_ConnStatus(pID) - возвращает статус подключения. 1 - работает, 0 - остановлено, -1 - не инициализировано.

_ConnCfgPath(pID) - возвращает путь к конфигу подключения.

_ReloadCfg() - дает команду перечитывания конфиг-файлов.

_SendCount() - возвращает количество отправленых на сервер файлов.

_RecvCount() - возвращает количество полученных файлов.

_ReadCfg(pFile, pPrm) - читает из конфига указанный параметр.
pFile указывает путь к файлу конфига. Можно использовать конструкцию .\<имя файла>, чтобы указать файл в каталоге Программы.
pPrm - имя параметра.

_RemCfg(pFile, pPrm) - удаляет из конфига указанный параметр.
pFile указывает путь к файлу конфига. Можно использовать конструкцию .\<имя файла>, чтобы указать файл в каталоге Программы.
pPrm - имя параметра.

_WriteCfg(pFile, pPrm, pVal) - запись параметра в конфиг. Если в файле не существует указанный параметр, он будет добавлен.
pFile указывает путь к файлу конфига. Можно использовать конструкцию .\<имя файла>, чтобы указать файл в каталоге Программы.
pPrm - имя параметра.
pVal - новое значение.

_WriteConnCfg(pID, pPrm, pVal) - запись параметра в конфиг подключения. Если в файле не существует указанный параметр, он будет добавлен.
pID указывает ID подключения.
pPrm - имя параметра.
pVal - новое значение.

_SendToCollector(pMsg) - отправка сообщения на сервер статистики.

_WriteToLog(pMsg) - запись сообщения в лог Программы.

_MngrAppPath() - возвращает полный путь к рабочему каталогу Программы.

_ShutdownMngr() - дает команду выключения Программы.

_ShutdownGuard() - дает команду выключения Guardian-а.

_StartGuard() - дает команду запуска Guardian-а. Возвращает 0 в случае успеха и -1 в случае ошибки.

_RestartGuard() - дает команду перезапуска Guardian-а. Возвращает 0 в случае успеха и -1 в случае ошибки.


	Кроме того, в скриптах можно использовать переменные, условия, циклы и еще многое другое. Если кому-то интересно, обратитесь к документации.

	Скрипт может выглядеть примерно так:


#begin DemoScript;

$capt = _ReadCfg('.\main.cfg', IndexVZ); //читаем параметр из конфига в переменную;

if ($capt == 84122)
  {
    _WriteCfg('.\Connections\demo.cfg', Caption, OLD); //меняем в файле параметр;
	
    $id = _ConnID(OLD); //получаем ид подключения;
	
    if ($id > 0)
      {
	_StopConn($id); //завершаем его работу;
      }
  }
  
#end;